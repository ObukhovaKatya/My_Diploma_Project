 cat ~/.ssh/id_ed25519.pub

ssh  4b505d05-1b5f-4b0d-9873-e3fe9839db4a.serverhub.praktikum-services.ru -p 4554

 psql -U morty -d scooter_rent  smith

\?
q
\c name
\c scooter_rent
\dt


 1. Логины курьеров с количеством заказов в доставке

SELECT 
    "Couriers"."login" AS courier_login, 
    COUNT("Orders"."courierId") AS in_delivery_count
FROM "Couriers"
INNER JOIN "Orders" 
    ON "Couriers"."id" = "Orders"."courierId"
WHERE "Orders"."inDelivery" = TRUE
GROUP BY "Couriers"."login"
ORDER BY in_delivery_count DESC, "Couriers"."login";

 2. Все трекеры заказов с вычисленным статусом

SELECT 
    "track" AS order_track,
    CASE 
        WHEN "finished" = TRUE THEN 2
        WHEN "cancelled" = TRUE THEN -1
        WHEN "inDelivery" = TRUE THEN 1
        ELSE 0
    END AS order_status
FROM "Orders"
ORDER BY "track";
